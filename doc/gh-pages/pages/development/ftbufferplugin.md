---
title: MNE-SCAN FieldTrip Buffer Plugin
parent: Develop
nav_order: 7
---

# MNE-SCAN FieldTrip Buffer Plugin

The plugin interface with a FieldTrip Buffer running at a given address. It does not implement the buffer itself, only a client. It is non-invasive, and does not even have access to the neuromag directly, only the data pushed to the buffer.

## Running with Neuromag

1. Download FieldTrip neuromag2ft

   Download the fieldtrip source code on your acquisition computer, either from their [website](http://www.fieldtriptoolbox.org/download/) or their [github page](https://github.com/fieldtrip/fieldtrip). We are interested in the executable `neuromag2ft`, which will serve as both our bufer host and interface to push data to the buffer.

2. Get neuromag2ft set up

   We will need to be able to run `neuromag2ft` on the acquisition computer for the neuromag. Depending on your system, you might have to build it locally. You can do so by running the makefile in `/realtime/src/acquisition/neuromag/` with the command `make`. If in doubt, follow the [documentation](http://www.fieldtriptoolbox.org/development/realtime/neuromag/) on the fieldtrip buffer website.

3. Set up .fif file on client computer

   On the aquisition computer, obtain a fif file generated by the neuromag with current sampling parameters. This can be done by getting a quick measurment and saving it to a file. Place that fif file in the folder from which you run MNE-SCAN on your client computer; this is usually under `/mne-cpp/bin`. Name that file `neuromag2ft.fif`. 

4. Run neuromag2ft

   Run neuromag2ft on the aquisition computer. neuromag2ft can be run with different parameters, but for this example we will be running it with all default settings. For more options, run it with the `--help` flag. Run the executable in `/realtime/src/acquisition/neuromag/bin/<YOUR_OS>`. This should both create a buffer and start an interface with the neuromag. This buffer will, by default, be hosted on port 1972.

5. Set up plugin:

   Run MNE-Scan and select the FtBuffer plugin from the toolbar on the left. Set the buffer address, which will be the IP address of your aquisition computer, and port, which by default is 1972. Click the 'Set' button. This does not start any connection or communication with the buffer, it only stores the values inputted in the 'Address' and 'Port' fields. At this stage the fif file gets loaded and used to set the plugin's output parameters.

6. Send and receive data:

   In MNE-Scan, click the green start button on the top left to start the plugin. This can be done before or after the data collection starts, but the fieldtrip buffer has a limited memory and will start dropping the oldest stored data samples once it starts running out. For best results, have the client plugin running before recording starts, or start it soon after.

-------------------

