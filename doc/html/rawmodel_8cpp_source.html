<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>MNE-CPP: D:/Users/Christoph/GitHub/mne-cpp/applications/mne_browse_raw_qt/Models/rawmodel.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MNE-CPP
   &#160;<span id="projectnumber">beta 1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="dir_65eb5ee1265c0bdbfc750ac7f32cd8f3.html">mne_browse_raw_qt</a></li><li class="navelem"><a class="el" href="dir_2fa6e5bc98950d7da550b0285dacd21d.html">Models</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rawmodel.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rawmodel_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span><span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// INCLUDES</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rawmodel_8h.html">rawmodel.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// USED NAMESPACES</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_m_n_e_browse_raw_qt.html">MNEBrowseRawQt</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// DEFINE MEMBER METHODS</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//=============================================================================================================</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;RawModel::RawModel(QObject *parent)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;: QAbstractTableModel(parent)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;, m_bFileloaded(false)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;, m_bStartReached(false)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;, m_bEndReached(false)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;, m_bReloading(false)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;, m_bProcessing(false)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;, m_fiffInfo(<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html">FiffInfo</a>())</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;, m_pfiffIO(QSharedPointer&lt;<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FiffIO</a>&gt;(new <a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FiffIO</a>()))</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;, m_filterChType(<span class="stringliteral">&quot;All&quot;</span>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    m_iWindowSize = MODEL_WINDOW_SIZE;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    m_reloadPos = MODEL_RELOAD_POS;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    m_maxWindows = MODEL_MAX_WINDOWS;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    m_iFilterTaps = MODEL_NUM_FILTER_TAPS;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//Set default sampling freq to 1024</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    m_fiffInfo.sfreq = 1024;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Generate default filter operator - This needs to be done here so that the filter design tool works without loading a file</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    genStdFilterOps();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//connect data reloading - this is done concurrently</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    connect(&amp;m_reloadFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;MatrixXd,MatrixXd&gt; &gt;::finished,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        insertReloadedData(m_reloadFutureWatcher.future().result());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    });</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//connect filtering reloading - this is done after a new block has been loaded</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    connect(<span class="keyword">this</span>,&amp;<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a09c224bbafd12914b5acf2842462a08f">RawModel::dataReloaded</a>,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span>(!m_assignedOperators.empty())</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            updateOperatorsConcurrently();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    });</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;int,RowVectorXd&gt; &gt;::resultReadyAt,[this](int index){</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//        insertProcessedData(index);</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//    });</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;void&gt;::finished,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        insertProcessedDataAll();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    });</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;int,RowVectorXd&gt; &gt;::progressValueChanged,[this](int progressValue){</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//        qDebug() &lt;&lt; &quot;RawModel: ProgressValue m_operatorFutureWatcher, &quot; &lt;&lt; progressValue &lt;&lt; &quot; items processed out of&quot; &lt;&lt; m_listTmpChData.size();</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//    });</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;RawModel::RawModel(QFile &amp;qFile, QObject *parent)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;: QAbstractTableModel(parent)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;, m_bFileloaded(false)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;, m_bStartReached(false)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;, m_bEndReached(false)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;, m_bReloading(false)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;, m_bProcessing(false)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;, m_fiffInfo(<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html">FiffInfo</a>())</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;, m_pfiffIO(QSharedPointer&lt;<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FiffIO</a>&gt;(new <a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FiffIO</a>()))</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;, m_filterChType(<span class="stringliteral">&quot;All&quot;</span>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    m_iWindowSize = MODEL_WINDOW_SIZE;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    m_reloadPos = MODEL_RELOAD_POS;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    m_maxWindows = MODEL_MAX_WINDOWS;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    m_iFilterTaps = MODEL_NUM_FILTER_TAPS;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//read fiff data</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    loadFiffData(&amp;qFile);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//generator FilterOperator objects</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    genStdFilterOps();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//connect signal and slots</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    connect(&amp;m_reloadFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;MatrixXd,MatrixXd&gt; &gt;::finished,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        insertReloadedData(m_reloadFutureWatcher.future().result());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    });</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    connect(<span class="keyword">this</span>,&amp;<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a09c224bbafd12914b5acf2842462a08f">RawModel::dataReloaded</a>,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span>(!m_assignedOperators.empty())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            updateOperatorsConcurrently();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    });</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;int,RowVectorXd&gt; &gt;::resultReadyAt,[this](int index){</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//        insertProcessedData(index);</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//    });</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;void&gt;::finished,[<span class="keyword">this</span>](){</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        insertProcessedDataAll();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    });</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//    connect(&amp;m_operatorFutureWatcher,&amp;QFutureWatcher&lt;QPair&lt;int,RowVectorXd&gt; &gt;::progressValueChanged,[this](int progressValue){</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//        qDebug() &lt;&lt; &quot;RawModel: ProgressValue m_operatorFutureWatcher, &quot; &lt;&lt; progressValue &lt;&lt; &quot; items processed out of&quot; &lt;&lt; m_listTmpChData.size();</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">//    });</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">//virtual functions</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a83a2adfed3a7b18e9e3cb99a5654905e">  152</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a83a2adfed3a7b18e9e3cb99a5654905e">RawModel::rowCount</a>(<span class="keyword">const</span> QModelIndex &amp; <span class="comment">/*parent*/</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.empty())</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">int</span> RawModel::columnCount(<span class="keyword">const</span> QModelIndex &amp; <span class="comment">/*parent*/</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;QVariant RawModel::data(<span class="keyword">const</span> QModelIndex &amp;index, <span class="keywordtype">int</span> role)<span class="keyword"> const</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span>(role != Qt::DisplayRole &amp;&amp; role != Qt::BackgroundRole &amp;&amp; role != RawModelRoles::GetChannelMean)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (index.isValid()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">//******** first column (chname) ********</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span>(index.column()==0 &amp;&amp; role == Qt::DisplayRole)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">return</span> QVariant(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[index.row()].ch_name);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//******** second column (data plot) ********</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span>(index.column()==1) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            QVariant v;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">switch</span>(role) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">case</span> Qt::DisplayRole: {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="comment">//form RowVectorPair of pointer and length of RowVector</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                QPair&lt;const double*,qint32&gt; rowVectorPair;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="comment">//pack all adjacent (after reload) RowVectorPairs into a QList</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                QList&lt;RowVectorPair&gt; listRowVectorPair;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">for</span>(qint16 i=0; i &lt; m_data.size(); ++i) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <span class="comment">//if channel is not filtered or background Processing pending...</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    <span class="keywordflow">if</span>(!m_assignedOperators.contains(index.row()) || (m_bProcessing &amp;&amp; m_bReloadBefore &amp;&amp; i==0) || (m_bProcessing &amp;&amp; !m_bReloadBefore &amp;&amp; i==m_data.size()-1)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        rowVectorPair.first = m_data[i]-&gt;dataRaw().data() + index.row()*m_data[i]-&gt;dataRaw().cols();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        rowVectorPair.second  = m_data[i]-&gt;dataRaw().cols();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <span class="keywordflow">else</span> { <span class="comment">//if channel IS filtered</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        rowVectorPair.first = m_data[i]-&gt;dataProc().data() + index.row()*m_data[i]-&gt;dataProc().cols();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        rowVectorPair.second  = m_data[i]-&gt;dataProc().cols();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    listRowVectorPair.append(rowVectorPair);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                v.setValue(listRowVectorPair);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">case</span> Qt::BackgroundRole: { <span class="comment">//plot channel red if marked as red</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.contains(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[index.row()].ch_name)) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    QBrush brush;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    brush.setStyle(Qt::SolidPattern);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//                    qDebug() &lt;&lt; m_chInfolist[index.row()].ch_name &lt;&lt; &quot;is marked as bad, index:&quot; &lt;&lt; index.row();</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    brush.setColor(Qt::darkRed);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    <span class="keywordflow">return</span> QVariant(brush);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">//******** third column (mean data of the channels plot) ********</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span>(index.column()==2) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">switch</span>(role) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">case</span> RawModelRoles::GetChannelMean: {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                QVariant v;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="comment">//if channel is not filtered or background Processing pending...</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">if</span>(!m_assignedOperators.contains(index.row()) || (m_bProcessing &amp;&amp; m_bReloadBefore) || (m_bProcessing &amp;&amp; !m_bReloadBefore)) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <span class="comment">//Calculate the global mean of all loaded data in m_dataMean</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <span class="keywordtype">double</span> sum = 0;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        sum += m_data[i]-&gt;dataRawMean(index.row());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    v.setValue(sum/m_data.size());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">else</span> { <span class="comment">//if channel IS filtered</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <span class="comment">//Calculate the global mean of all loaded data in m_dataMean</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <span class="keywordtype">double</span> sum = 0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                        sum += m_data[i]-&gt;dataProcMean(index.row());</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    v.setValue(sum/m_data.size());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            } <span class="comment">// end role switch</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        } <span class="comment">// end column check</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    } <span class="comment">// end index.valid() check</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;QVariant RawModel::headerData(<span class="keywordtype">int</span> section, Qt::Orientation orientation, <span class="keywordtype">int</span> role)<span class="keyword"> const</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span>(role != Qt::DisplayRole &amp;&amp; role != Qt::TextAlignmentRole)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span>(orientation == Qt::Horizontal) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">switch</span>(section) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">case</span> 0: <span class="comment">//chname column</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">case</span> 1: <span class="comment">//data plot column</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">switch</span>(role) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">case</span> Qt::DisplayRole:</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordflow">return</span> QVariant(<span class="stringliteral">&quot;data plot&quot;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">case</span> Qt::TextAlignmentRole:</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">return</span> QVariant(Qt::AlignLeft);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(orientation == Qt::Vertical) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        QModelIndex chname = createIndex(section,0);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">switch</span>(role) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">case</span> Qt::DisplayRole:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">return</span> QVariant(data(chname).toString());</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> QVariant();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">void</span> RawModel::genStdFilterOps()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//clear operators</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//m_Operators.clear();</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">//regenerate them with the correct sampling frequency (only required for naming of filter)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">double</span> sfreq = (<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#a963c80bf73b01ed07eb1a31540cf308c">sfreq</a>&gt;=0) ? <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#a963c80bf73b01ed07eb1a31540cf308c">sfreq</a> : 600.0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">double</span> nyquist_freq = sfreq/2;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">int</span> fftLength = m_iWindowSize;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">int</span> exp = ceil(MNEMath::log2(fftLength));</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    fftLength = pow(2, exp+1);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    m_iCurrentFFTLength = fftLength;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    FilterOperator::DesignMethod dMethod = FilterOperator::Cosine;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//HPF</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">double</span> cutoffFreqHz = 50; <span class="comment">//in Hz</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    QString name = QString(<span class="stringliteral">&quot;HPF_%1&quot;</span>).arg(cutoffFreqHz);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.insert(name,QSharedPointer&lt;MNEOperator&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>(name,FilterOperator::HPF,m_iFilterTaps,cutoffFreqHz/nyquist_freq,5/nyquist_freq,1/nyquist_freq,sfreq,fftLength,dMethod)));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//LPF</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    cutoffFreqHz = 30; <span class="comment">//in Hz</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    name = QString(<span class="stringliteral">&quot;LPF_%1&quot;</span>).arg(cutoffFreqHz);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.insert(name,QSharedPointer&lt;MNEOperator&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>(name,FilterOperator::LPF,m_iFilterTaps,cutoffFreqHz/nyquist_freq,5/nyquist_freq,1/nyquist_freq,sfreq,fftLength,dMethod)));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    cutoffFreqHz = 10; <span class="comment">//in Hz</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    name = QString(<span class="stringliteral">&quot;LPF_%1&quot;</span>).arg(cutoffFreqHz);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.insert(name,QSharedPointer&lt;MNEOperator&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>(name,FilterOperator::LPF,m_iFilterTaps,cutoffFreqHz/nyquist_freq,5/nyquist_freq,1/nyquist_freq,sfreq,fftLength,dMethod)));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">//BPF</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">double</span> from_freqHz = 30;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">double</span> to_freqHz = 40;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">double</span> trans_width = 5;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">double</span> bw = to_freqHz-from_freqHz; <span class="comment">//double bw = to_freqHz/from_freqHz;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">double</span> center = from_freqHz+bw/2;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    name = QString(<span class="stringliteral">&quot;BPF_%1-%2&quot;</span>).arg(from_freqHz).arg(to_freqHz);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.insert(name,QSharedPointer&lt;MNEOperator&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>(name,FilterOperator::BPF,80,(<span class="keywordtype">double</span>)center/nyquist_freq,(<span class="keywordtype">double</span>)bw/nyquist_freq,(<span class="keywordtype">double</span>)trans_width/nyquist_freq,sfreq,fftLength,dMethod)));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">//Own/manual set filter - only an entry i nthe operator list generated which is called when the filterwindow is used</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    cutoffFreqHz = 40;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">//only create if filter does not exist yet</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.contains(QString(<span class="stringliteral">&quot;User defined (See &#39;Adjust/Filter&#39;)&quot;</span>))) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        name = QString(<span class="stringliteral">&quot;User defined (See &#39;Adjust/Filter&#39;)&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">m_Operators</a>.insert(name,QSharedPointer&lt;MNEOperator&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>(name,FilterOperator::LPF,m_iFilterTaps,cutoffFreqHz/nyquist_freq,5/nyquist_freq,1/nyquist_freq,sfreq,(m_iWindowSize+m_iFilterTaps),dMethod)));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">//**********</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//filter debugging -&gt; store filter coefficients to plain text file</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">//    QFile file(&quot;C:/Users/Flo/Desktop/matlab/filter.txt&quot;);</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">//    file.open(QFile::WriteOnly | QFile::Text);</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//    QTextStream out(&amp;file);</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//    QSharedPointer&lt;FilterOperator&gt; filtPtr = m_Operators[name].staticCast&lt;FilterOperator&gt;();</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//    for(int i=0; i &lt; filtPtr-&gt;m_dCoeffA.cols(); ++i)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">//        out &lt;&lt; filtPtr-&gt;m_dCoeffA(0,i) &lt;&lt; endl;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">//    file.close();</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//**********</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Standard FilterOperators generated and loaded.&quot;</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a162b376ac606a2dd365be2e182fd22a5">  362</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a162b376ac606a2dd365be2e182fd22a5">RawModel::loadFiffData</a>(QFile* qFile)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    beginResetModel();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    clearModel();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    MatrixXd t_data,t_times; <span class="comment">//type is later on (when append to m_data) casted into MatrixXdR (Row-Major)</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    QSharedPointer&lt;DataPackage&gt; newDataPackage;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a> = QSharedPointer&lt;FiffIO&gt;(<span class="keyword">new</span> <a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FiffIO</a>(*qFile));</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw.empty()) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        m_iAbsFiffCursor = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;first_samp; <span class="comment">//Set cursor somewhere into fiff file [in samples]</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        m_bStartReached = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordtype">int</span> start = m_iAbsFiffCursor;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordtype">int</span> end = start + m_iWindowSize - 1;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;read_raw_segment(t_data, t_times, start, end))</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        newDataPackage = QSharedPointer&lt;DataPackage&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_data_package.html">DataPackage</a>(t_data, (MatrixXdR)t_times));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a405875049e369b002f955403b781aa68">m_bFileloaded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        qDebug(<span class="stringliteral">&quot;RawModel: ERROR! Data set does not contain any fiff data!&quot;</span>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        endResetModel();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a405875049e369b002f955403b781aa68">m_bFileloaded</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">//set loaded fiff data</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    m_data.append(newDataPackage);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    loadFiffInfos();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    genStdFilterOps();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    endResetModel();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    qFile-&gt;close();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a9e4d0f115890a2a18a6987d561709a8d">fileLoaded</a>(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a41902880535c09f254afdeb25a101340">  411</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a41902880535c09f254afdeb25a101340">RawModel::writeFiffData</a>(QIODevice *p_IODevice)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    RowVectorXd cals;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    SparseMatrix&lt;double&gt; mult;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    RowVectorXi sel;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//    std::cout &lt;&lt; &quot;Writing file &quot; &lt;&lt; QFile(&amp;p_IODevice).fileName().toLatin1() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_stream.html#afc5bb6ae857cf5e93e4e0271bf0bee05">FiffStream::SPtr</a> outfid = Fiff::start_writing_raw(*p_IODevice,<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>,cals);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">//Setup reading parameters</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    fiff_int_t from = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    fiff_int_t to = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a4e0e97a726c6d6bcf27c526685bc98b2">lastSample</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">float</span> quantum_sec = 10.0f;<span class="comment">//read and write in 10 sec junks</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    fiff_int_t quantum = ceil(quantum_sec*<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#a963c80bf73b01ed07eb1a31540cf308c">sfreq</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Uncomment to read the whole file at once. Warning MAtrix may be none-initialisable because its huge</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">//quantum = to - from + 1;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Read and write all the data</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">bool</span> first_buffer = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    fiff_int_t first, last;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    MatrixXd data;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    MatrixXd times;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    emit writeProgressRangeChanged(from, to);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span>(first = from; first &lt; to; first+=quantum) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        last = first+quantum-1;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">if</span> (last &gt; to)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            last = to;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;read_raw_segment(data,times,mult,first,last,sel)) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            qDebug(<span class="stringliteral">&quot;error during read_raw_segment\n&quot;</span>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        qDebug(<span class="stringliteral">&quot;Writing...&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (first_buffer) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;           <span class="keywordflow">if</span> (first &gt; 0)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;               outfid-&gt;write_int(FIFF_FIRST_SAMPLE,&amp;first);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;           first_buffer = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        outfid-&gt;write_raw_buffer(data,mult);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        qDebug(<span class="stringliteral">&quot;[done]\n&quot;</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        emit writeProgressChanged(first);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    outfid-&gt;finish_writing_raw();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//non-virtual functions</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">//private</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">void</span> RawModel::loadFiffInfos()</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//loads chinfos</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;info.nchan; ++i)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.append(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;info.chs[i]);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//loads fiffInfo</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a> = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;info;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordtype">void</span> RawModel::clearModel()</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">//FiffIO object</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>.clear();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#adc07a81c63cfb3796fde6b49bfa419d1">clear</a>();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.clear();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">//data model structure</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    m_data.clear();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//MNEOperators</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    m_assignedOperators.clear();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//View parameters</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    m_iAbsFiffCursor = 0;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    m_iCurAbsScrollPos = 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    m_bStartReached = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    m_bEndReached = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    qDebug(<span class="stringliteral">&quot;RawModel cleared.&quot;</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordtype">void</span> RawModel::resetPosition(qint32 position)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    beginResetModel();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">//reset members</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    m_data.clear();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    m_bStartReached = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    m_bEndReached = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    m_bReloading = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">//calculate multiple integer of m_iWindowSize from beginning of Fiff file (rounded down)</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    qint32 distance = position - <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    qint32 mult = floor(distance / m_iWindowSize);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    m_iAbsFiffCursor = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>() + mult*m_iWindowSize;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    MatrixXd t_data,t_times; <span class="comment">//type is later on (when append to m_data) casted into MatrixXdR (Row-Major)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">int</span> start = m_iAbsFiffCursor;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">int</span> end = start + m_iWindowSize - 1;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    m_Mutex.lock();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;read_raw_segment(t_data, t_times, start, end))</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Error resetting position of Fiff file!&quot;</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    m_Mutex.unlock();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//build data package</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    QSharedPointer&lt;DataPackage&gt; newDataPackage;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    newDataPackage = QSharedPointer&lt;DataPackage&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_data_package.html">DataPackage</a>((MatrixXdR)t_data, (MatrixXdR)t_times));</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">//append loaded block</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    m_data.append(newDataPackage);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span>(!m_assignedOperators.empty())</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">updateOperators</a>();</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    endResetModel();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//    if(!(m_iAbsFiffCursor&lt;=firstSample()))</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">//        updateScrollPos(m_iCurAbsScrollPos-firstSample()); //little hack: if the m_iCurAbsScrollPos is now close to the edge -&gt; force reloading w/o scrolling</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Model Position RESET, samples from &quot;</span> &lt;&lt; m_iAbsFiffCursor &lt;&lt; <span class="stringliteral">&quot;to&quot;</span> &lt;&lt; m_iAbsFiffCursor+m_iWindowSize-1 &lt;&lt; <span class="stringliteral">&quot;reloaded. actual loaded t_data cols: &quot;</span> &lt;&lt; t_data.cols();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    emit dataChanged(createIndex(0,1),createIndex(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(),1));</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="keywordtype">void</span> RawModel::reloadFiffData(<span class="keywordtype">bool</span> before)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    m_bReloadBefore = before;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">//update scroll position</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    fiff_int_t start,end;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span>(before) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        m_iAbsFiffCursor -= m_iWindowSize;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        start = m_iAbsFiffCursor;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        end = start + m_iWindowSize - 1;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">//check if start of fiff file is reached</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">if</span>(start &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>()) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            m_bStartReached = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Start of fiff file reached.&quot;</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            m_iAbsFiffCursor = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment">//resetPosition(m_iAbsFiffCursor);</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        start = m_iAbsFiffCursor + <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7ab39b592e71218b0dd3e29ed9bdfe4c">sizeOfPreloadedData</a>();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        end = start + m_iWindowSize - 1;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">//check if end of fiff file is reached</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span>(end &gt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a4e0e97a726c6d6bcf27c526685bc98b2">lastSample</a>()) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="comment">//Reload one more time</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">if</span>(m_bEndReached)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                m_bEndReached = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            end = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a4e0e97a726c6d6bcf27c526685bc98b2">lastSample</a>();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: End of fiff file reached.&quot;</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    m_bReloading = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">//read data with respect to start and end point</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    QFuture&lt;QPair&lt;MatrixXd,MatrixXd&gt; &gt; future = QtConcurrent::run(<span class="keyword">this</span>,&amp;RawModel::readSegment,start,end);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">//Wait for thread reloading is finished, then insert reloaded data</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">//future.waitForFinished();</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">//insertReloadedData(future.result());</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    m_reloadFutureWatcher.setFuture(future);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;QPair&lt;MatrixXd,MatrixXd&gt; RawModel::readSegment(fiff_int_t from, fiff_int_t to)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    QPair&lt;MatrixXd,MatrixXd&gt; datatime;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    m_Mutex.lock();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">m_pfiffIO</a>-&gt;m_qlistRaw[0]-&gt;read_raw_segment(datatime.first, datatime.second, from, to)) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        printf(<span class="stringliteral">&quot;RawModel: Error when reading raw data!&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">return</span> datatime;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    m_Mutex.unlock();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span> datatime;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">//public SLOTS</span></div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2f300aa109777ee1c023624ad56a806">  628</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2f300aa109777ee1c023624ad56a806">RawModel::updateScrollPos</a>(<span class="keywordtype">int</span> value)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    m_iCurAbsScrollPos = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>() + value;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: absolute Fiff Scroll Cursor&quot;</span> &lt;&lt; m_iCurAbsScrollPos &lt;&lt; <span class="stringliteral">&quot;(m_iAbsFiffCursor&quot;</span> &lt;&lt; m_iAbsFiffCursor &lt;&lt; <span class="stringliteral">&quot;, sizeOfPreloadedData&quot;</span> &lt;&lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7ab39b592e71218b0dd3e29ed9bdfe4c">sizeOfPreloadedData</a>() &lt;&lt; <span class="stringliteral">&quot;, firstSample()&quot;</span> &lt;&lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">firstSample</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">//if a scroll position is selected, which is not within the loaded data range -&gt; reset position of model</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span>(m_iCurAbsScrollPos &gt; (m_iAbsFiffCursor+<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7ab39b592e71218b0dd3e29ed9bdfe4c">sizeOfPreloadedData</a>()+m_iWindowSize) || m_iCurAbsScrollPos &lt; m_iAbsFiffCursor) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Reset position requested, m_iAbsFiffCursor:&quot;</span> &lt;&lt; m_iAbsFiffCursor &lt;&lt; <span class="stringliteral">&quot;m_iCurAbsScrollPos:&quot;</span> &lt;&lt; m_iCurAbsScrollPos;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        resetPosition(m_iCurAbsScrollPos);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">//reload data if end of loaded range is reached and no relaoding is currently active</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">//front</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span>(!m_bReloading &amp;&amp; (m_iCurAbsScrollPos-m_iAbsFiffCursor &lt; m_reloadPos) &amp;&amp; !m_bStartReached) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Reload requested at FRONT of loaded fiff data, m_iAbsFiffCursor:&quot;</span> &lt;&lt; m_iAbsFiffCursor &lt;&lt; <span class="stringliteral">&quot;m_iCurAbsScrollPos:&quot;</span> &lt;&lt; m_iCurAbsScrollPos;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        reloadFiffData(1);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">//end</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!m_bReloading &amp;&amp; m_iCurAbsScrollPos &gt; m_iAbsFiffCursor+<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7ab39b592e71218b0dd3e29ed9bdfe4c">sizeOfPreloadedData</a>()-m_reloadPos &amp;&amp; !m_bEndReached) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Reload requested at END of loaded fiff data, m_iAbsFiffCursor:&quot;</span> &lt;&lt; m_iAbsFiffCursor &lt;&lt; <span class="stringliteral">&quot;m_iCurAbsScrollPos:&quot;</span> &lt;&lt; m_iCurAbsScrollPos;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        reloadFiffData(0);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ac1059d1508a0cea81ab8a0d35dcd411b">  656</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ac1059d1508a0cea81ab8a0d35dcd411b">RawModel::markChBad</a>(QModelIndexList chlist, <span class="keywordtype">bool</span> status)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;{</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; chlist.size(); ++i) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span>(chlist[i].column() == 1) {<span class="comment">//only process indexes corresponding to column 1 (data)</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">if</span>(status) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.contains(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name))</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.append(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel:&quot;</span> &lt;&lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name &lt;&lt; <span class="stringliteral">&quot;marked as bad.&quot;</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.contains(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name)) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    <span class="keywordtype">int</span> index = <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.indexOf(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">m_fiffInfo</a>.<a class="code" href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">bads</a>.removeAt(index);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel:&quot;</span> &lt;&lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>[chlist[i].row()].ch_name &lt;&lt; <span class="stringliteral">&quot;marked as good.&quot;</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            emit dataChanged(chlist[i],chlist[i]);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2ee46a50f611e0fdc99fb138fac2f54">  681</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2ee46a50f611e0fdc99fb138fac2f54">RawModel::applyOperator</a>(QModelIndexList chlist, <span class="keyword">const</span> QSharedPointer&lt;MNEOperator&gt;&amp; operatorPtr, <span class="keyword">const</span> QString &amp;chType)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    m_filterChType = chType;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">//clear channel list becuase we will generate a new one</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    chlist.clear();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//filter only channels which include chType in their names</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span>(chType == <span class="stringliteral">&quot;All&quot;</span>) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(); ++i) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;STI&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;MISC&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;TRG&quot;</span>))</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <span class="keywordflow">if</span>(!m_assignedOperators.values(i).contains(operatorPtr))</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    m_assignedOperators.insertMulti(i,operatorPtr);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(); ++i) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;STI&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;MISC&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;TRG&quot;</span>) &amp;&amp; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(chType))</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <span class="keywordflow">if</span>(!m_assignedOperators.values(i).contains(operatorPtr))</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    m_assignedOperators.insertMulti(i,operatorPtr);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    m_bProcessing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        updateOperatorsConcurrently(i);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: using FilterType&quot;</span> &lt;&lt; operatorPtr-&gt;m_sName;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a49dec97b891e7d419a47ba06cc1e648f">  721</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2ee46a50f611e0fdc99fb138fac2f54">RawModel::applyOperator</a>(QModelIndexList chlist, <span class="keyword">const</span> QSharedPointer&lt;MNEOperator&gt;&amp; operatorPtr)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">//filter all when chlist is empty</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span>(chlist.empty()) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(); ++i) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span>(chlist.at(i).column()==1)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;STI&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;MISC&quot;</span>) &amp;&amp; !<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(<span class="stringliteral">&quot;TRG&quot;</span>))</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    <span class="keywordflow">if</span>(!m_assignedOperators.values(i).contains(operatorPtr))</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        m_assignedOperators.insertMulti(i,operatorPtr);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; chlist.size(); ++i) {  <span class="comment">//iterate through selected channels to filter</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">if</span>(chlist.at(i).column()==1) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            QString chName = data(index(i,0)).toString();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">if</span>(!chName.contains(<span class="stringliteral">&quot;STI&quot;</span>) &amp;&amp; !chName.contains(<span class="stringliteral">&quot;MISC&quot;</span>) &amp;&amp; !chName.contains(<span class="stringliteral">&quot;TRG&quot;</span>))</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">if</span>(!m_assignedOperators.values(chlist.at(i).row()).contains(operatorPtr))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    m_assignedOperators.insertMulti(chlist.at(i).row(),operatorPtr);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    m_bProcessing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        updateOperatorsConcurrently(i);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: using FilterType&quot;</span> &lt;&lt; operatorPtr-&gt;m_sName;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2c0cb976d9ea6e74795e5322f7ce7566">  759</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2c0cb976d9ea6e74795e5322f7ce7566">RawModel::applyOperatorsConcurrently</a>(QPair&lt;int,RowVectorXd&gt;&amp; chdata)<span class="keyword"> const</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    QSharedPointer&lt;FilterOperator&gt; filter;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">//QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    QList&lt;QSharedPointer&lt;MNEOperator&gt; &gt; ops = m_assignedOperators.values(chdata.first);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; ops.size(); ++i) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keywordflow">switch</span>(ops[i]-&gt;m_OperatorType) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">case</span> MNEOperator::FILTER: {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            filter = ops[i].staticCast&lt;<a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">FilterOperator</a>&gt;();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            RowVectorXd tmp = filter-&gt;<a class="code" href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html#a9092b6147a406bb0c5ab2719ced93195">applyFFTFilter</a>(chdata.second);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            chdata.second = tmp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">case</span> MNEOperator::PCA: {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="comment">//do something</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">//    return chdata;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ac2712820e08b9a418031997d8293a68f">  784</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">RawModel::updateOperators</a>(QModelIndex chan)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;{</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; m_assignedOperators.values(chan.row()).size(); ++i) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">for</span>(qint32 j=0; j &lt; m_assignedOperators.values(chan.row()).size(); ++j) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="keywordflow">if</span>(!m_assignedOperators.values(chan.row()).contains(m_assignedOperators.values(chan.row())[j]))</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                m_assignedOperators.insertMulti(chan.row(), m_assignedOperators.values(chan.row())[j]);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    m_bProcessing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        updateOperatorsConcurrently(i);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a49904ce5f881b0ad4430d7bcfa264b86">  808</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">RawModel::updateOperators</a>(QModelIndexList chlist)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;{</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span>(chlist.empty())</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(); ++i)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            chlist.append(createIndex(i,1));</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; chlist.size(); ++i) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">for</span>(qint32 j=0; j &lt; m_assignedOperators.values(chlist[i].row()).size(); ++j) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordflow">if</span>(!m_assignedOperators.values(chlist[i].row()).contains(m_assignedOperators.values(chlist[i].row())[j]))</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                m_assignedOperators.insertMulti(chlist[i].row(), m_assignedOperators.values(chlist[i].row())[j]);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    m_bProcessing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;m_data.size(); i++)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        updateOperatorsConcurrently(i);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">  836</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">RawModel::updateOperators</a>()</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;{</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">updateOperators</a>(QModelIndexList());</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;}</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2da4e091091ceb4df443b23b99db996a">  844</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">RawModel::undoFilter</a>(QModelIndexList chlist, <span class="keyword">const</span> QSharedPointer&lt;MNEOperator&gt; &amp;filterPtr)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;{</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; chlist.size(); ++i) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span>(m_assignedOperators.contains(chlist[i].row()) &amp;&amp; m_assignedOperators.values(chlist[i].row()).contains(filterPtr)) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            QMutableMapIterator&lt;int,QSharedPointer&lt;MNEOperator&gt; &gt; it(m_assignedOperators);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">while</span>(it.hasNext()) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                it.next();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <span class="keywordflow">if</span>(it.key()==chlist[i].row() &amp;&amp; it.value()==filterPtr) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    it.remove();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Filter operator removed of type&quot;</span> &lt;&lt; filterPtr-&gt;m_sName &lt;&lt; <span class="stringliteral">&quot;for channel&quot;</span> &lt;&lt; chlist[i].row();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">updateOperators</a>(chlist[i]);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: No filter of type&quot;</span> &lt;&lt; filterPtr-&gt;m_sName &lt;&lt; <span class="stringliteral">&quot;applied to channel&quot;</span> &lt;&lt; chlist[i].row();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;}</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a4698086faff860451fe2eabe67c04a0e">  872</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">RawModel::undoFilter</a>(QModelIndexList chlist)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; chlist.size(); ++i) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        m_assignedOperators.remove(chlist[i].row());</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: All filter operator removed of type for channel&quot;</span> &lt;&lt; chlist[i].row();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;}</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#afcc1b92e64ce84f6bed5a788628efb94">  885</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">RawModel::undoFilter</a>(<span class="keyword">const</span> QString &amp;chType)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span>(chType == <span class="stringliteral">&quot;All&quot;</span>)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">undoFilter</a>();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="comment">//filter only channels which include chType in their names</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">for</span>(qint32 i=0; i &lt; <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(); ++i)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.at(i).ch_name.contains(chType))</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                m_assignedOperators.remove(i);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">  902</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">RawModel::undoFilter</a>()</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    m_assignedOperators.clear();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">assignedOperatorsChanged</a>(m_assignedOperators);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">//private SLOTS</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keywordtype">void</span> RawModel::insertReloadedData(QPair&lt;MatrixXd,MatrixXd&gt; dataTimesPair)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    QSharedPointer&lt;DataPackage&gt; newDataPackage = QSharedPointer&lt;DataPackage&gt;(<span class="keyword">new</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_data_package.html">DataPackage</a>((MatrixXdR)dataTimesPair.first, (MatrixXdR)dataTimesPair.second));</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">//extend m_data with reloaded data</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span>(m_bReloadBefore) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        m_data.prepend(newDataPackage);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">//maintain at maximum m_maxWindows data windows and drop the rest</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">if</span>(m_data.size() &gt; m_maxWindows) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            m_data.removeLast();</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        m_data.append(newDataPackage);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">//maintain at maximum m_maxWindows data windows and drop the rest</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span>(m_data.size() &gt; m_maxWindows) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            m_data.removeFirst();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            m_iAbsFiffCursor += m_iWindowSize;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    m_bReloading = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    emit dataChanged(createIndex(0,1),createIndex(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size()-1,1));</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    emit <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a09c224bbafd12914b5acf2842462a08f">dataReloaded</a>();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Fiff data Reloaded from &quot;</span> &lt;&lt; dataTimesPair.second.coeff(0) &lt;&lt; <span class="stringliteral">&quot;secs to&quot;</span> &lt;&lt; dataTimesPair.second.coeff(dataTimesPair.second.cols()-1) &lt;&lt; <span class="stringliteral">&quot;secs&quot;</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;}</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordtype">void</span> RawModel::updateOperatorsConcurrently()</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;{</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    m_bProcessing = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    m_listTmpChData.clear();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">//get the rows which are to be filtered out of the m_data matrix. Note that this is done windows wise, hence jumps in the filtered signal might be visible</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; listFilteredChs.size(); ++i) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            m_listTmpChData.append(QPair&lt;int,RowVectorXd&gt;(listFilteredChs[i],m_data.first()-&gt;dataRawOrig().row(listFilteredChs[i])));</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            m_listTmpChData.append(QPair&lt;int,RowVectorXd&gt;(listFilteredChs[i],m_data.last()-&gt;dataRawOrig().row(listFilteredChs[i])));</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Starting of concurrent PROCESSING operation of&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;items&quot;</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">//************* here it could be also performed QtConcurrent::mapped() *************</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// advantage: QFutureWatcher would give partial results -&gt; signal resultsReadyAt(int idx)</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// disadvantage: data needs to be copied twice (also to QFuture&lt;QPair&lt;int,RowVectorXd&gt; &gt; object) instead of once (to m_listTmpChData)</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">//generate lambda function</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">//    std::function&lt;QPair&lt;int,RowVectorXd&gt; (QPair&lt;int,RowVectorXd&gt;&amp;)&gt; applyOps = [this](QPair&lt;int,RowVectorXd&gt;&amp; chdata) -&gt; QPair&lt;int,RowVectorXd&gt; {</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">//        return applyOperatorsConcurrently(chdata);</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">//    };</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">//    QFuture&lt;QPair&lt;int,RowVectorXd&gt; &gt; future = QtConcurrent::mapped(m_listTmpChData.begin(),m_listTmpChData.end(),applyOps);</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">//**************************************************************************************************************************************************************************</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    QFuture&lt;void &gt; future = QtConcurrent::map(m_listTmpChData,[<span class="keyword">this</span>](QPair&lt;int,RowVectorXd&gt;&amp; chdata) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2c0cb976d9ea6e74795e5322f7ce7566">applyOperatorsConcurrently</a>(chdata);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    });</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    m_operatorFutureWatcher.setFuture(future);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">//Wait for thread to be finished processig the data, then insert data</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">//future.waitForFinished();</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: finished concurrent PROCESSING operation of&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;items&quot;</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">//insertProcessedDataAll();</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;}</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="keywordtype">void</span> RawModel::updateOperatorsConcurrently(<span class="keywordtype">int</span> windowIndex)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;{</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span>(windowIndex &gt;= m_data.size() || windowIndex &lt; 0)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        windowIndex = 0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    m_listTmpChData.clear();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">//get the rows which are to be filtered out of the m_data matrix. Note that this is done windows wise, hence jumps in the filtered signal might be visible</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">for</span>(qint32 i=0; i &lt; listFilteredChs.size(); ++i) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            m_listTmpChData.append(QPair&lt;int,RowVectorXd&gt;(listFilteredChs[i],m_data[windowIndex]-&gt;dataRawOrig().row(listFilteredChs[i])));</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            m_listTmpChData.append(QPair&lt;int,RowVectorXd&gt;(listFilteredChs[i],m_data[windowIndex]-&gt;dataRawOrig().row(listFilteredChs[i])));</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Starting of concurrent PROCESSING operation of&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;items in m_data block&quot;</span>&lt;&lt;windowIndex;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">//************* here it could be also performed QtConcurrent::mapped() *************</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// advantage: QFutureWatcher would give partial results -&gt; signal resultsReadyAt(int idx)</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// disadvantage: data needs to be copied twice (also to QFuture&lt;QPair&lt;int,RowVectorXd&gt; &gt; object) instead of once (to m_listTmpChData)</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">//generate lambda function</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">//    std::function&lt;QPair&lt;int,RowVectorXd&gt; (QPair&lt;int,RowVectorXd&gt;&amp;)&gt; applyOps = [this](QPair&lt;int,RowVectorXd&gt;&amp; chdata) -&gt; QPair&lt;int,RowVectorXd&gt; {</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">//        return applyOperatorsConcurrently(chdata);</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">//    };</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">//    QFuture&lt;QPair&lt;int,RowVectorXd&gt; &gt; future = QtConcurrent::mapped(m_listTmpChData.begin(),m_listTmpChData.end(),applyOps);</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">//**************************************************************************************************************************************************************************</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    QFuture&lt;void &gt; future = QtConcurrent::map(m_listTmpChData,[<span class="keyword">this</span>](QPair&lt;int,RowVectorXd&gt;&amp; chdata) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2c0cb976d9ea6e74795e5322f7ce7566">applyOperatorsConcurrently</a>(chdata);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    });</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">//Wait for thread to be finished processig the data, then insert data</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    future.waitForFinished();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: finished concurrent PROCESSING operation of&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;items&quot;</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    insertProcessedDataAll(windowIndex);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keywordtype">void</span> RawModel::insertProcessedDataRow(<span class="keywordtype">int</span> rowIndex)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">int</span> dataLength = m_iWindowSize;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        dataLength = m_data.first()-&gt;dataRaw().cols();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        dataLength = m_data.last()-&gt;dataRaw().cols();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordtype">int</span> cutFront = m_iCurrentFFTLength/4;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordtype">int</span> cutBack = m_iCurrentFFTLength/4 + (m_listTmpChData[0].second.cols()-m_iCurrentFFTLength/2-dataLength);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        m_data.first()-&gt;setOrigProcData(m_listTmpChData[rowIndex].second, m_listTmpChData[rowIndex].first, cutFront, cutBack);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        m_data.last()-&gt;setOrigProcData(m_listTmpChData[rowIndex].second, m_listTmpChData[rowIndex].first, cutFront, cutBack);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    emit dataChanged(createIndex(listFilteredChs[rowIndex],1),createIndex(listFilteredChs[rowIndex],1));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span>(rowIndex == listFilteredChs.last())</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keywordtype">void</span> RawModel::insertProcessedDataAll(<span class="keywordtype">int</span> windowIndex)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span>(windowIndex &gt;= m_data.size() || windowIndex &lt; 0 || m_assignedOperators.empty())</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        windowIndex = 0;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordtype">int</span> dataLength = m_data[windowIndex]-&gt;dataRaw().cols();;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordtype">int</span> cutFront = m_iCurrentFFTLength/4;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">int</span> cutBack = m_iCurrentFFTLength/4 + (m_listTmpChData[0].second.cols()-m_iCurrentFFTLength/2-dataLength);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">//Set and cut original data to window size and calculate mean for filtered data</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; listFilteredChs.size(); ++i)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        m_data[windowIndex]-&gt;setOrigProcData(m_listTmpChData[i].second, listFilteredChs[i], cutFront, cutBack);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    emit dataChanged(createIndex(0,1),createIndex(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(),1));</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Finished inserting&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;channels in window &quot;</span>&lt;&lt;windowIndex;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;}</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordtype">void</span> RawModel::insertProcessedDataAll()</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;{</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordtype">int</span> dataLength = m_iWindowSize;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        dataLength = m_data.first()-&gt;dataRaw().cols();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        dataLength = m_data.last()-&gt;dataRaw().cols();</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordtype">int</span> cutFront = m_iCurrentFFTLength/4;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordtype">int</span> cutBack = m_iCurrentFFTLength/4 + (m_listTmpChData[0].second.cols()-m_iCurrentFFTLength/2-dataLength);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">//Set and cut original data to window size and calculate mean for filtered data</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; listFilteredChs.size(); ++i) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">if</span>(m_bReloadBefore)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            m_data.first()-&gt;setOrigProcData(m_listTmpChData[i].second, listFilteredChs[i], cutFront, cutBack);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            m_data.last()-&gt;setOrigProcData(m_listTmpChData[i].second, listFilteredChs[i], cutFront, cutBack);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    performOverlapAdd();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    emit dataChanged(createIndex(0,1),createIndex(<a class="code" href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">m_chInfolist</a>.size(),1));</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    qDebug() &lt;&lt; <span class="stringliteral">&quot;RawModel: Finished inserting&quot;</span> &lt;&lt; listFilteredChs.size() &lt;&lt; <span class="stringliteral">&quot;channels.&quot;</span>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    m_bProcessing = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keywordtype">void</span> RawModel::performOverlapAdd()</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;{</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span>(m_data.empty() || m_data.size()&lt;2)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">//Overlap add window data</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordtype">int</span> numberWin = m_data.size();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">int</span> cols = m_data[0]-&gt;dataProcOrig().cols();</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordtype">int</span> filterLength = m_iCurrentFFTLength/2; <span class="comment">//Total number of zeros which needed to be added to compensate the covolution size increasement. zeroTaper/2 zeros were added at front and back of the data</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordtype">int</span> zeroFFT;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">//Iterate through window data</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;numberWin; i++) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j&lt;listFilteredChs.size(); j++) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            RowVectorXd front = RowVectorXd::Zero(cols);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            RowVectorXd back = RowVectorXd::Zero(cols);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="comment">//First window</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordflow">if</span>(i==0) {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                zeroFFT = m_iCurrentFFTLength - filterLength - m_data[i]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                back.segment(cols-filterLength-zeroFFT, filterLength) =</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                        m_data[i+1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(0, filterLength);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="comment">//Middle windows</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            <span class="keywordflow">if</span>(i &gt; 0 &amp;&amp; i &lt; numberWin-1) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                zeroFFT = m_iCurrentFFTLength - filterLength - m_data[i-1]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                front.segment(0, filterLength) =</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        m_data[i-1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(cols-filterLength-zeroFFT, filterLength);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                zeroFFT = m_iCurrentFFTLength - filterLength - m_data[i]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                back.segment(cols-filterLength-zeroFFT, filterLength) =</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                        m_data[i+1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(0, filterLength);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="comment">//Last window</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">if</span>(i == numberWin-1) {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                zeroFFT = m_iCurrentFFTLength - filterLength - m_data[i-1]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                front.segment(0, filterLength) =</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                        m_data[i-1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(cols-filterLength-zeroFFT, filterLength);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">//Do the overlap add</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            zeroFFT = m_iCurrentFFTLength - filterLength - m_data[i]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            m_data[i]-&gt;setMappedProcData(m_data[i]-&gt;dataProcOrig().row(listFilteredChs[j])+front+back,</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                                       listFilteredChs[j],</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                       filterLength/2,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                       filterLength/2+zeroFFT);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">//            QFile file(&quot;D:/inputData.txt&quot;);</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">//            file.open(QFile::WriteOnly | QFile::Text);</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">//            QTextStream out(&amp;file);</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//            for(int i=0; i &lt; m_listTmpChData[0].second.cols(); ++i)</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">//                out &lt;&lt; m_listTmpChData[0].second(0,i) &lt;&lt; endl;</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">//            file.close();</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">//            QFile file1(&quot;D:/front.txt&quot;);</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">//            file1.open(QFile::WriteOnly | QFile::Text);</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">//            QTextStream out1(&amp;file1);</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">//            for(int i=0; i &lt; front.cols(); ++i)</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">//                out1 &lt;&lt; front(0,i) &lt;&lt; endl;</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">//            file1.close();</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">//            QFile file2(&quot;D:/back.txt&quot;);</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">//            file2.open(QFile::WriteOnly | QFile::Text);</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">//            QTextStream out2(&amp;file2);</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">//            for(int i=0; i &lt; back.cols(); ++i)</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">//                out2 &lt;&lt; back(0,i) &lt;&lt; endl;</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">//            file2.close();</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">//            RowVectorXd result = m_listTmpChData[j].second+front+back;</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">//            QFile file3(&quot;D:/result.txt&quot;);</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">//            file3.open(QFile::WriteOnly | QFile::Text);</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">//            QTextStream out3(&amp;file3);</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">//            for(int i=0; i &lt; result.cols(); ++i)</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">//                out3 &lt;&lt; result(0,i) &lt;&lt; endl;</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">//            file3.close();</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">//*************************************************************************************************************</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="keywordtype">void</span> RawModel::performOverlapAdd(<span class="keywordtype">int</span> windowIndex)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;{</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span>(windowIndex&lt;0 || windowIndex&gt;m_data.size()-1 || m_data.size()&lt;2)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    QList&lt;int&gt; listFilteredChs = m_assignedOperators.keys();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">//Overlap add window data</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordtype">int</span> numberWin = m_data.size();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordtype">int</span> cols = m_data[windowIndex]-&gt;dataProcOrig().cols();</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordtype">int</span> filterLength = m_iCurrentFFTLength/2; <span class="comment">//Total number of zeros which needed to be added to compensate the covolution size increasement. zeroTaper/2 zeros were added at front and back of the data</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordtype">int</span> zeroFFT;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j&lt;listFilteredChs.size(); j++) {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        RowVectorXd front = RowVectorXd::Zero(cols);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        RowVectorXd back = RowVectorXd::Zero(cols);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="comment">//First window</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">if</span>(windowIndex==0) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            zeroFFT = m_iCurrentFFTLength - filterLength - m_data[windowIndex]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            back.segment(cols-filterLength-zeroFFT, filterLength) =</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    m_data[windowIndex+1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(0, filterLength);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">//Middle windows</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span>(windowIndex &gt; 0 &amp;&amp; windowIndex &lt; numberWin-1) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            zeroFFT = m_iCurrentFFTLength - filterLength - m_data[windowIndex-1]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            front.segment(0, filterLength) =</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    m_data[windowIndex-1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(cols-filterLength-zeroFFT, filterLength);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            zeroFFT = m_iCurrentFFTLength - filterLength - m_data[windowIndex]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            back.segment(cols-filterLength-zeroFFT, filterLength) =</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                    m_data[windowIndex+1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(0, filterLength);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="comment">//Last window</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordflow">if</span>(windowIndex == numberWin-1) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            zeroFFT = m_iCurrentFFTLength - filterLength - m_data[windowIndex-1]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            front.segment(0, filterLength) =</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    m_data[windowIndex-1]-&gt;dataProcOrig().row(listFilteredChs[j]).segment(cols-filterLength-zeroFFT, filterLength);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="comment">//Do the overlap add</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        zeroFFT = m_iCurrentFFTLength - filterLength - m_data[windowIndex]-&gt;dataRaw().cols(); <span class="comment">//The total number of zeros added to compensate for multiple integer of 2^x</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        m_data[windowIndex]-&gt;setMappedProcData(m_data[windowIndex]-&gt;dataProcOrig().row(listFilteredChs[j])+front+back,</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                                   listFilteredChs[j],</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                   filterLength/2,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                   filterLength/2+zeroFFT);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a8e3568868c449532c1357967314dd919"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a8e3568868c449532c1357967314dd919">MNEBrowseRawQt::RawModel::m_pfiffIO</a></div><div class="ttdeci">QSharedPointer&lt; FiffIO &gt; m_pfiffIO</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00182">rawmodel.h:182</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a9e4d0f115890a2a18a6987d561709a8d"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a9e4d0f115890a2a18a6987d561709a8d">MNEBrowseRawQt::RawModel::fileLoaded</a></div><div class="ttdeci">void fileLoaded(const FiffInfo &amp;)</div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_info_html"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_info.html">FIFFLIB::FiffInfo</a></div><div class="ttdoc">FIFF measurement file information. </div><div class="ttdef"><b>Definition:</b> <a href="fiff__info_8h_source.html#l00096">fiff_info.h:96</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_data_package_html"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_data_package.html">MNEBrowseRawQt::DataPackage</a></div><div class="ttdoc">The DataPackage class provides central place to hold all program relevant data. </div><div class="ttdef"><b>Definition:</b> <a href="datapackage_8h_source.html#l00088">datapackage.h:88</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a5b8678608f453f20e94fcfda747387ff"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5b8678608f453f20e94fcfda747387ff">MNEBrowseRawQt::RawModel::m_chInfolist</a></div><div class="ttdeci">QList&lt; FiffChInfo &gt; m_chInfolist</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00180">rawmodel.h:180</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_af2f300aa109777ee1c023624ad56a806"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2f300aa109777ee1c023624ad56a806">MNEBrowseRawQt::RawModel::updateScrollPos</a></div><div class="ttdeci">void updateScrollPos(int value)</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00628">rawmodel.cpp:628</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a83a2adfed3a7b18e9e3cb99a5654905e"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a83a2adfed3a7b18e9e3cb99a5654905e">MNEBrowseRawQt::RawModel::rowCount</a></div><div class="ttdeci">virtual int rowCount(const QModelIndex &amp;parent=QModelIndex()) const </div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00152">rawmodel.cpp:152</a></div></div>
<div class="ttc" id="namespace_m_n_e_browse_raw_qt_html"><div class="ttname"><a href="namespace_m_n_e_browse_raw_qt.html">MNEBrowseRawQt</a></div><div class="ttdef"><b>Definition:</b> <a href="averagedelegate_8h_source.html#l00062">averagedelegate.h:62</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a2c0cb976d9ea6e74795e5322f7ce7566"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a2c0cb976d9ea6e74795e5322f7ce7566">MNEBrowseRawQt::RawModel::applyOperatorsConcurrently</a></div><div class="ttdeci">void applyOperatorsConcurrently(QPair&lt; int, RowVectorXd &gt; &amp;chdata) const </div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00759">rawmodel.cpp:759</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_filter_operator_html_a9092b6147a406bb0c5ab2719ced93195"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html#a9092b6147a406bb0c5ab2719ced93195">MNEBrowseRawQt::FilterOperator::applyFFTFilter</a></div><div class="ttdeci">RowVectorXd applyFFTFilter(const RowVectorXd &amp;data) const </div><div class="ttdef"><b>Definition:</b> <a href="filteroperator_8cpp_source.html#l00163">filteroperator.cpp:163</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_af2ee46a50f611e0fdc99fb138fac2f54"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#af2ee46a50f611e0fdc99fb138fac2f54">MNEBrowseRawQt::RawModel::applyOperator</a></div><div class="ttdeci">void applyOperator(QModelIndexList chlist, const QSharedPointer&lt; MNEOperator &gt; &amp;operatorPtr, const QString &amp;chType)</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00681">rawmodel.cpp:681</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a09c224bbafd12914b5acf2842462a08f"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a09c224bbafd12914b5acf2842462a08f">MNEBrowseRawQt::RawModel::dataReloaded</a></div><div class="ttdeci">void dataReloaded()</div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_ac1059d1508a0cea81ab8a0d35dcd411b"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ac1059d1508a0cea81ab8a0d35dcd411b">MNEBrowseRawQt::RawModel::markChBad</a></div><div class="ttdeci">void markChBad(QModelIndexList chlist, bool status)</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00656">rawmodel.cpp:656</a></div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_stream_html_afc5bb6ae857cf5e93e4e0271bf0bee05"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_stream.html#afc5bb6ae857cf5e93e4e0271bf0bee05">FIFFLIB::FiffStream::SPtr</a></div><div class="ttdeci">QSharedPointer&lt; FiffStream &gt; SPtr</div><div class="ttdef"><b>Definition:</b> <a href="fiff__stream_8h_source.html#l00132">fiff_stream.h:132</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a1e4833f1c224c28552ab1ae262094b37"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a1e4833f1c224c28552ab1ae262094b37">MNEBrowseRawQt::RawModel::m_Operators</a></div><div class="ttdeci">QMap&lt; QString, QSharedPointer&lt; MNEOperator &gt; &gt; m_Operators</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00183">rawmodel.h:183</a></div></div>
<div class="ttc" id="rawmodel_8h_html"><div class="ttname"><a href="rawmodel_8h.html">rawmodel.h</a></div><div class="ttdoc">This class represents the model of the model/view framework of mne_browse_raw_qt application. It is derived from QAbstractTableModel so the virtual functions rowCount(),columnCount() and data() needed to be reimplemented. The delegate requests the data for any individual table cell by invoking data(QModelIndex index, int role) and a certain role. DisplayRole is the standard role for requesting the plain data. Other roles such as BackgroundRole are requested to fill a cell with a certain background color with respect to the individual index. For further information see [1]. </div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a7e629f2ed1a8b6147621ca0442f7ccab"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7e629f2ed1a8b6147621ca0442f7ccab">MNEBrowseRawQt::RawModel::m_fiffInfo</a></div><div class="ttdeci">FiffInfo m_fiffInfo</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00181">rawmodel.h:181</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a41902880535c09f254afdeb25a101340"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a41902880535c09f254afdeb25a101340">MNEBrowseRawQt::RawModel::writeFiffData</a></div><div class="ttdeci">bool writeFiffData(QIODevice *p_IODevice)</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00411">rawmodel.cpp:411</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_filter_operator_html"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_filter_operator.html">MNEBrowseRawQt::FilterOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="filteroperator_8h_source.html#l00106">filteroperator.h:106</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a405875049e369b002f955403b781aa68"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a405875049e369b002f955403b781aa68">MNEBrowseRawQt::RawModel::m_bFileloaded</a></div><div class="ttdeci">bool m_bFileloaded</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00179">rawmodel.h:179</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a718528d73fa4e9eb650aec3247d0a2c6"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a718528d73fa4e9eb650aec3247d0a2c6">MNEBrowseRawQt::RawModel::assignedOperatorsChanged</a></div><div class="ttdeci">void assignedOperatorsChanged(const QMap&lt; int, QSharedPointer&lt; MNEOperator &gt; &gt; &amp;)</div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a77159bb9a436ee03c7059a114ae30671"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a77159bb9a436ee03c7059a114ae30671">MNEBrowseRawQt::RawModel::firstSample</a></div><div class="ttdeci">qint32 firstSample() const </div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00512">rawmodel.h:512</a></div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_info_base_html_abb2b7b298afe7439c1012962c2a8c43c"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_info_base.html#abb2b7b298afe7439c1012962c2a8c43c">FIFFLIB::FiffInfoBase::bads</a></div><div class="ttdeci">QStringList bads</div><div class="ttdef"><b>Definition:</b> <a href="fiff__info__base_8h_source.html#l00204">fiff_info_base.h:204</a></div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_i_o_html"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_i_o.html">FIFFLIB::FiffIO</a></div><div class="ttdef"><b>Definition:</b> <a href="fiff__io_8h_source.html#l00081">fiff_io.h:81</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a5a211c6de27fab445ae9fa9411ebb749"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a5a211c6de27fab445ae9fa9411ebb749">MNEBrowseRawQt::RawModel::updateOperators</a></div><div class="ttdeci">void updateOperators()</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00836">rawmodel.cpp:836</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a162b376ac606a2dd365be2e182fd22a5"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a162b376ac606a2dd365be2e182fd22a5">MNEBrowseRawQt::RawModel::loadFiffData</a></div><div class="ttdeci">bool loadFiffData(QFile *qFile)</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00362">rawmodel.cpp:362</a></div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_info_html_adc07a81c63cfb3796fde6b49bfa419d1"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#adc07a81c63cfb3796fde6b49bfa419d1">FIFFLIB::FiffInfo::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="fiff__info_8cpp_source.html#l00108">fiff_info.cpp:108</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_ab8b96131e4b89b69ed8d4e01a0853021"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#ab8b96131e4b89b69ed8d4e01a0853021">MNEBrowseRawQt::RawModel::undoFilter</a></div><div class="ttdeci">void undoFilter()</div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8cpp_source.html#l00902">rawmodel.cpp:902</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a7ab39b592e71218b0dd3e29ed9bdfe4c"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a7ab39b592e71218b0dd3e29ed9bdfe4c">MNEBrowseRawQt::RawModel::sizeOfPreloadedData</a></div><div class="ttdeci">qint32 sizeOfPreloadedData() const </div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00530">rawmodel.h:530</a></div></div>
<div class="ttc" id="class_m_n_e_browse_raw_qt_1_1_raw_model_html_a4e0e97a726c6d6bcf27c526685bc98b2"><div class="ttname"><a href="class_m_n_e_browse_raw_qt_1_1_raw_model.html#a4e0e97a726c6d6bcf27c526685bc98b2">MNEBrowseRawQt::RawModel::lastSample</a></div><div class="ttdeci">qint32 lastSample() const </div><div class="ttdef"><b>Definition:</b> <a href="rawmodel_8h_source.html#l00521">rawmodel.h:521</a></div></div>
<div class="ttc" id="class_f_i_f_f_l_i_b_1_1_fiff_info_html_a963c80bf73b01ed07eb1a31540cf308c"><div class="ttname"><a href="class_f_i_f_f_l_i_b_1_1_fiff_info.html#a963c80bf73b01ed07eb1a31540cf308c">FIFFLIB::FiffInfo::sfreq</a></div><div class="ttdeci">float sfreq</div><div class="ttdef"><b>Definition:</b> <a href="fiff__info_8h_source.html#l00260">fiff_info.h:260</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 27 2015 08:53:50 for MNE-CPP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
